---
import Layout from "../../layouts/Layout.astro";
import { getDogs, getDogBySlug } from "../../utils/sanity";
import type { Dogs } from "../../utils/sanity"; // Type-only import for Dogs

export async function getStaticPaths() {
  const dogs: Dogs[] = await getDogs();
  return dogs.filter(dog => dog.slug?.current).map(dog => ({
    params: { slug: dog.slug?.current || '' },
  }));
}

const slug: string = Astro.params.slug ?? ''; // Ensure slug is always a string
const dog: Dogs | null = await getDogBySlug(slug);
---
<Layout title={dog && dog.name ? dog.name : 'Dog not found'}>
  <a href="/">Back</a>

  {dog ? (
    <section class="dog">
      <h1>{dog.name}</h1>
      <p>Sex: {dog.sex}</p>
      {dog.photo && (
        <img
          src={dog.photo.asset.url}
          alt={dog.photo.alt || 'Dog image'}
        />
      )}
      {/* Add any other dog details you want to display */}
    </section>
  ) : (
    <p>Dog not found</p>
  )}
</Layout>
