---
import Layout from "../../layouts/Layout.astro";
import { getDogs, getDogBySlug } from "../../utils/sanity";
import type { Dogs } from "../../utils/sanity"; // Type-only import for Dogs

export async function getStaticPaths() {
  const dogs: Dogs[] = await getDogs();
  return dogs.filter(dog => dog.slug?.current).map(dog => ({
    params: { slug: dog.slug?.current || '' },
  }));
}

const slug: string = Astro.params.slug ?? ''; // Ensure slug is always a string
const dog: Dogs | null = await getDogBySlug(slug);
---
<Layout title={dog && dog.name ? dog.name : 'Dog not found'}>
  <a href="/">Back</a>

  {dog ? (
    <section class="dog">

      <div class="info">
        <h1>{dog.name}</h1>
        <p>Sex: {dog.sex}</p>
      </div>

      {dog.photo && (
        <img
          src={dog.photo.asset.url + "?w=1000"}
          alt={dog.photo.alt || 'Dog image'}
        />
      )}
      {/* Add any other dog details you want to display */}
    </section>
  ) : (
    <p>Dog not found</p>
  )}
</Layout>

<style>
  .dog {
    border: 3px solid var(--grey);
    max-width: 60rem;
    display: grid;
    grid-template-columns: 1fr 3fr;
    margin-block-start: 1em;
  }

  .info {
    background: var(--yellow);
    color: var(--dark);
    padding: 2em;
  }

  h1 {
    text-transform: lowercase;
  }

  img {
    width: 100%;
    max-height: 30em;
    object-fit: cover;
  }
</style>